{{ define "title" }}{{ .Title }} | {{ .Site.Title }}{{ end }}

{{ define "main" }}
<div class="list-page">
    <h1>{{ .Title }}</h1>

    {{ if .Content }}
    <div class="content-intro">
        {{ .Content }}
    </div>
    {{ end }}

    {{ $currentTopic := "" }}
    {{ $currentPath := .RelPermalink }}

    {{/* Extract topic from the current page's path */}}
    {{ $pathParts := split .RelPermalink "/" }}
    {{ if ge (len $pathParts) 3 }}
    {{ $currentTopic = index $pathParts 2 }}
    {{ end }}

    {{ range .Site.RegularPages }}
    {{ if and (eq .Params.topic $currentTopic) (ne .RelPermalink $currentPath) }}
    <article class="summary-card">
        <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
        <div class="summary-meta">
            <span>ğŸ“… {{ .Date.Format "January 2, 2006" }}</span>
            <span>ğŸ·ï¸ {{ .Params.topicName }}</span>
            <span>ğŸ“° {{ .Params.articleCount }} articles</span>
        </div>
        <div class="summary-excerpt">
            {{ partial "overall-highlights.html" . }}
        </div>
        <a href="{{ .Permalink }}" class="read-more-btn">Read Full Summary â†’</a>
    </article>
    {{ end }}
    {{ else }}
    <p class="empty-state">
        No summaries available yet for this topic.
    </p>
    {{ end }}
</div>
{{ end }}