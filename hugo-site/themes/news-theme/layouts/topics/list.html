{{ define "title" }}Topics | {{ .Site.Title }}{{ end }}

{{ define "main" }}
<div class="topics-page">
    <h1>Topics</h1>
    <p class="section-intro">
        Select a topic below to view all news summaries for that specific area of coverage.
    </p>

    <div class="topics-grid">
        {{ $allPages := where .Site.RegularPages "Section" "summaries" }}
        {{ $topics := slice }}
        {{ range $allPages }}
            {{ $topics = $topics | append .Params.topic }}
        {{ end }}
        {{ $uniqueTopics := uniq $topics }}

        {{ range $uniqueTopics }}
            {{ $topicId := . }}
            {{ $topicPages := where $allPages "Params.topic" $topicId }}
            {{ $firstPage := index $topicPages 0 }}
            <div class="topic-card">
                <a href="{{ printf "/summaries/%s/" $topicId | absURL }}">
                    <h3>{{ $firstPage.Params.topicName }}</h3>
                    <p class="topic-count">
                        {{ len $topicPages }} summaries
                    </p>
                </a>
            </div>
        {{ else }}
        <p class="empty-state empty-state--full">
            No topics available yet. Topics will appear after the first summaries are generated.
        </p>
        {{ end }}
    </div>
</div>
{{ end }}
